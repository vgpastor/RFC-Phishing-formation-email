<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
<!-- generated by https://github.com/cabo/kramdown-rfc version 1.7.8 (Ruby 3.0.2) -->
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" ipr="trust200902" docName="draft-vgpastor-email-phishing-training-00" category="info" submissionType="IETF" xml:lang="en" version="3">
  <!-- xml2rfc v2v3 conversion 3.20.1 -->
  <front>
    <title abbrev="Phishing Detection Training Headers">Proposal for the Introduction of Email Headers for Phishing Detection Training</title>
    <seriesInfo name="Internet-Draft" value="draft-vgpastor-email-phishing-training-00"/>
    <author initials="V. G. P." surname="vgpastor" fullname="Victor Garcia Pastor" role="editor">
      <organization/>
      <address>
        <email>vgpastor08@gmail.com</email>
        <uri>https://twitter.com/vgpastor</uri>
      </address>
    </author>
    <date year="2024" month="April" day="02"/>
    <area>Internet Applications and Services</area>
    <workgroup>Internet Engineering Task Force</workgroup>
    <keyword>phishing</keyword>
    <keyword>email</keyword>
    <keyword>security training</keyword>
    <keyword>DNS</keyword>
    <keyword>cybersecurity</keyword>
    <keyword>email headers</keyword>
    <abstract>
      <?line 34?>

<t>This document proposes the addition of new email headers designed specifically to identify emails that are sent as part of phishing detection training programs. These headers would allow recipients to verify the authenticity of training emails using DNS queries to confirm that the sending domains are authorized to send these types of emails.</t>
    </abstract>
  </front>
  <middle>
    <?line 37?>

<section anchor="introduction">
      <name>Introduction</name>
      <t>Phishing remains one of the most significant security threats on the Internet today. Training users to detect phishing attempts is a crucial tool in defending against these types of attacks. However, the effectiveness of these training programs can be compromised if emails used for training are incorrectly flagged and filtered by anti-phishing solutions.</t>
      <t>This paper proposes a solution to this problem by introducing specific headers in training emails that would allow email systems to correctly identify them and prevent their filtering, while also providing a verification mechanism to confirm the legitimacy of these emails. .</t>
      <section anchor="goals">
        <name>Goals</name>
        <t>The main objective of this proposal is to improve the effectiveness of phishing detection training programs by introducing a mechanism that allows email systems to identify and authenticate training emails, maintaining security in email systems and avoiding abuse of this mechanism.</t>
        <t>The main motivation behind this proposal is to improve the effectiveness of phishing detection training programs. Currently, emails used in these programs can be incorrectly flagged as phishing attempts by anti-phishing solutions, which can lead to users not receiving proper training or the emails being filtered before they can be used for training.</t>
        <t>Finally, it is very important that users can use phishing detection reporting systems to improve the use of these systems, as well as train users themselves in the detection and prevention of this type of attacks. These reports must be able to discard phishing detection training emails so as not to generate false positives, as well as be able to forward said emails to phishing detection training providers so they can be analyzed and improved.</t>
      </section>
      <section anchor="description-of-the-proposal">
        <name>Description of the Proposal</name>
        <t>The proposal consists of the following main elements, addition of email headers, sender legitimation and link validation mechanism.</t>
        <section anchor="adding-email-headers">
          <name>Adding Email Headers</name>
          <t>The proposal includes the introduction of new email headers for phishing detection training emails:
- Phishing-Simulation: Mandatory | A unique identifier for the training session. It can be shared between multiple recipients, but cannot be repeated for the same recipient.
- Phishing-Simulation-Provider: Required | The domain of the phishing detection training provider.
- Phishing-Simulation-Auth: Required | DNS record that contains the email authentication information.
- Phishing-Simulation-Report: Optional | A link or email to report phishing detection training emails.</t>
          <section anchor="phishing-simulation-header">
            <name>Phishing-Simulation Header</name>
            <t>Unique identifier for the training session.
This identifier allows identification of the email as a phishing simulation and allows email systems to perform DNS queries to verify the authenticity of the email.
At a training level it can be used to measure the effectiveness of specific phishing detection training.</t>
            <t><tt>Phishing-Simulation: unic-identifier</tt></t>
          </section>
          <section anchor="phishing-simulation-provider-header">
            <name>Phishing-Simulation-Provider Header</name>
            <t>Identification of the phishing detection training provider.
This field allows email systems to identify the domain of the training provider and use it to verify the authenticity of the email.
The same company may have several phishing detection training providers, so it is important that this header be mandatory.</t>
            <t>By using user phishing detection reporting systems, you can identify which phishing detection training providers are being most effective and those who need improvement. Finally you can use these rules to filter reported messages.</t>
            <t><tt>Phishing-Simulation-Provider: example.com</tt></t>
          </section>
          <section anchor="phishing-simulation-auth-header">
            <name>Phishing-Simulation-Auth Header</name>
            <t>DNS record that contains the email authentication information.
This record must be dynamic for each domain since it allows you to publicly hide whether a domain uses this type of phishing detection training.</t>
            <t><tt>Phishing-Simulation-Auth: xxxxxxxxxxxx</tt></t>
          </section>
          <section anchor="phishing-simulation-report-header">
            <name>Phishing-Simulation-Report Header</name>
            <t>Email address or url endpoint where to send the reported email through a PUT request.
It is important that the original headers of the email be sent to the mailbox or url endpoint for analysis, also allowing their analysis.
<tt>Phishing-Simulation-Report: reports@example.com</tt></t>
          </section>
        </section>
        <section anchor="dns-verification-mechanism">
          <name>DNS Verification Mechanism</name>
          <t>Details how mail systems can use the proposed headers to perform DNS queries and verify the authenticity of training emails.</t>
          <t>The domain owner must add a TXT record in their DNS with the following format:
The DNS record should be dynamic for each domain, this way it can be hidden if a domain uses this type of phishing detection training.</t>
          <t>The content of the registry stores both the emails authorized to send the emails and the domains authorized for the links.</t>
          <t><tt>xxxxxxxxxxxx.example.com TXT v:pdt1; sender:domain-that-send-email.com,domain-that-send-email2.com ;links:domain-links.com,domain-links.com</tt></t>
          <t>It is also necessary that the values can be authorized externally, in case a provider needs to modify, add or delete domains for both sending and links, clients do not have to continually modify their own records.</t>
          <t>Provider DNS entry
<tt>_pdt.example.com TXT v:pdt1; sender:domain-that-send-email.com,domain-that-send-email2.com ;links:domain-links.com,domain-links2.com</tt></t>
          <t>Client DNS entry
<tt>xxxxxxxxxxx.example.net TXT v:pdt1; sender:domain-that-send-email3.com,_pdt.example.com ;links:domain-links3.com,_pdt.example.com</tt></t>
        </section>
        <section anchor="link-validation-mechanism">
          <name>Link Validation Mechanism</name>
          <t>Validating links within the email is an important step in preventing users from clicking on malicious links. The addition of a link validation mechanism is proposed to allow email systems to verify the authenticity of links in training emails.</t>
          <t>It must be verified that all the links contained in the body of the email are within those enabled in the DNS record of the sender's domain.</t>
        </section>
        <section anchor="email-report">
          <name>Email Report</name>
          <t>When the end user receives a phishing training email that is identified by the user as such, the user may use the usual means for reporting this email.</t>
          <t>The mail provider, or the email client, when the header in the email <tt>Phishing-Simulation-Report</tt> exists, may send the email to the email address or link provided in the header so that the detection training provider of phishing can analyze the email and improve its training, it is important that this report includes the original headers of the email for analysis.</t>
        </section>
      </section>
      <section anchor="implementation">
        <name>Implementation</name>
        <ol spacing="normal" type="1"><li>
            <t>Phishing detection training providers should implement the proposed email headers in their training emails.</t>
          </li>
          <li>
            <t>Phishing detection training providers must legitimize their authorized domains for both sending emails and links to avoid abuse of this mechanism.</t>
          </li>
          <li>
            <t>Customers must configure their DNS records with the necessary values to allow verification of training emails.</t>
          </li>
          <li>
            <t>The email system upon receiving a phishing detection training email must perform a DNS query to verify the authenticity of the email and the links contained in the email.
            </t>
            <ol spacing="normal" type="1"><li>
                <t>If the DNS query is successful, the email continues verification.</t>
              </li>
              <li>
                <t>It checks if the sender's domain is authorized to send phishing detection training emails.</t>
              </li>
              <li>
                <t>It is checked if the links contained in the email are authorized to be used in phishing detection training emails.</t>
              </li>
              <li>
                <t>If the verification is successful, the email is delivered to the recipient. If any of the previous steps fail, the email should be marked as suspicious.</t>
              </li>
            </ol>
          </li>
          <li>
            <t>Users should use phishing detection reporting systems to report suspicious emails and improve the effectiveness of phishing detection training programs.
            </t>
            <ol spacing="normal" type="1"><li>
                <t>The email system will send the reported email to the phishing detection training provider for analysis and improvement.</t>
              </li>
              <li>
                <t>If there is no entry for the report, the sending of the email to anti-phishing systems will be stopped and it will be marked as suspicious.</t>
              </li>
            </ol>
          </li>
        </ol>
        <section anchor="implementation-in-email-sending-provider">
          <name>Implementation in email sending provider</name>
          <t>When a client of an email sending provider, such as Sendgrid, Mailgun, etc., sends a phishing detection training email, the provider can verify if they are authorized to send this type of email to ensure proper use of the email. their systems.
1. The recipient of the phishing detection training email must have a DNS record with allowed origin information.
2. The email sending provider must perform a DNS query to verify the authenticity of the email and the legitimacy of the sender to send these emails to the recipient.</t>
        </section>
      </section>
      <section anchor="example">
        <name>Example</name>
        <ul spacing="normal">
          <li>
            <t>example.com -&gt; Phishing detection training provider domain</t>
          </li>
          <li>
            <t>example.net -&gt; Domain of the client that receives the phishing detection training email</t>
          </li>
          <li>
            <t>test.com -&gt; Domain used to send the phishing detection training email</t>
          </li>
          <li>
            <t>example.org -&gt; Domain used for links in the phishing detection training email</t>
          </li>
        </ul>
        <section anchor="dns-entries">
          <name>DNS entries</name>
          <t><tt>_pdt.example.com TXT v:pdt1; sender:test.com ;links:example.org</tt></t>
          <t><tt>2654896524568._pdt.example.net TXT v:pdt1; sender:_pdt.example.com ;links:_pdt.example.com</tt></t>
        </section>
        <section anchor="e-mail-sent">
          <name>E-Mail sent</name>
          <t>```
From: fake@mail.test.com
To: user@example.net
Subject: Message from CEO
Message-ID: <eref target="mailto:05c18622-f2ad-cb77-2ce9-a0bbfc7d7ad0@example.com">05c18622-f2ad-cb77-2ce9-a0bbfc7d7ad0@example.com</eref>
Date: Mon, 25 Mar 2024 10:00:00 -0400
Phishing-Simulation: fcbdc611-3807-4cfc-a521-f7beb4ca39ff
Phishing-Simulation-Provider: example.com
Phishing-Simulation-Auth: 2654896524568
Phishing-Simulation-Report: reports@example.com
Content-Type: text/plain; charset=utf-8</t>
          <t>Please send 1M USD to the following account: https://transfers.example.org/bank-account</t>
          <t>Regards
```</t>
        </section>
      </section>
    </section>
    <section anchor="Security">
      <name>Security</name>
      <t>The security implications of this proposal have been considered and recommendations have been provided to mitigate potential risks.</t>
      <t>Currently, no significant safety risks associated with this proposal have been identified. However, it is important that senders of training emails follow the security recommendations provided in this document to prevent abuse of this mechanism.</t>
      <t>This proposal does not take into account the enablement of sending emails to particular end users who use generic email accounts (google.com, live.com, etc.), however the email providers themselves could add this functionality to improve the security of its users, allowing each user to enable a phishing detection training provider.</t>
    </section>
    <section anchor="IANA">
      <name>IANA Considerations</name>
      <t>This document includes requests to IANA to register the proposed new email headers.</t>
    </section>
  </middle>
  <back>
    <?line 175?>

<section numbered="false" anchor="Acknowledgements">
      <name>Acknowledgements</name>
      <t>Special thanks to Zepo.app for the inspiration for the creation of this document and to all of you who have helped me review and improve this document.</t>
    </section>
    <section anchor="contributors" numbered="false" toc="include" removeInRFC="false">
      <name>Contributors</name>
      <contact initials="" surname="Zepo.app" fullname="Zepo.app">
        <organization/>
        <address>
          <email>info@zepo.app</email>
          <uri>https://zepo.app</uri>
        </address>
      </contact>
      <t>Inspiration for the creation of this document.</t>
    </section>
  </back>
  <!-- ##markdown-source:
H4sIAAAAAAAAA8VabXPbxhH+jl9xY39oO0PQFC35hWkyVi070UydaCLZ7fRL
fASO5FUggNwBopmX/95n914AUKTMJO00k0ko4LC7t/vs612apoltZJn/IIuq
VDPRmFYlujb8yzbTyeTlZJpkspkJXS6qxLbztbZWV2WzrbH+8s3N20QaJfGz
bJQpVSPO67rQ+ASLrABtca3Mnc6UTTbL3rI35VKXShldLsWNtLfibWUylSR5
lZVyDdq5kYsmvVvW0jaVSdVa6iKtV9qu8EnaGKlL+jGZJEmjmwJfPLoyVV1Z
WYhFZUSzUsTNVHmbkTCiWog3RER8o2SujOVVV56guFCNcutuPOlHiZzPjboj
wodXBWqPkkKW2KAqk9vNLBFCpCJI6/7iHbifVmWt0c1WhG24xxffXrsf2XYO
kn5R72uxcswS2TarysySVJiKtq5yDSVhpS7tTHwYfz2+GougOzx2Kv2gM/wp
vpYm01JchZdMehaXT168WtKTcVat8RYyzMSqaWo7e/Kk2egGBqRXTyL5DHAw
et42TiLH61+qrsayrjv6hKBXP3WPB4R7zyM5qHkmfqHtC1jS1towqqJ1MwAv
WLaBqgWw065V2YyTJE1TIecW+s2aJLnpvxU1w0RZJiJzqM4TKdVmqGeRK6uX
pcqFrVWmF8B1UcBqldA5KOnF1q0nUrIR8ASYFhykFbU0DdEMGACpAJ1gdBJk
aeTajsXNSlkVuW6qtsgFWFUbYcC31iBqie0dHAZMWXBAgGTICEekgUDVS9Ra
Buy31+LHFl8p/h66XWizduISFYibs3QVviKHNY5yZfRP2DY+oRW0FPKR01vi
5ViMWctrnecFHPfx44G7JdFnjHKkEWGcpZRYV7YRpFlWKRTWOcSKjEqLgwO7
cNFUudyOO69rLSkK4jm1dmqWwOe6BgVYXAIiLaBeYGFVAIBYvfAblksSqtnd
GT6X2S0s8k21UdD2iMVQiwXZ7k6Vylq/Cfpq15ACmxFzILNa4xFCJVSoF51F
8CeDN3xH2tZlVhlYuQGwFoVcLrGIwuZCF9g7/phv8XejY+wTtirYOWAAh+xa
1sp0sJZxBSmIPQPv5oVaEy3tjcSUPKoj8nR5D0cMlT4inYfYrYWiPaiC/NEr
oJ8176JGACWPwANt/J5AfCQ2K10AaoWtSLg77YziAO7Th1irbCVLbddD6CpR
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

-->

</rfc>
